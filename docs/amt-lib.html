<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 The amt-library | pdmphmc - numerical generalized randomized HMC processes for R</title>
  <meta name="description" content="Description in index.Rmd" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 The amt-library | pdmphmc - numerical generalized randomized HMC processes for R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Description in index.Rmd" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 The amt-library | pdmphmc - numerical generalized randomized HMC processes for R" />
  
  <meta name="twitter:description" content="Description in index.Rmd" />
  

<meta name="author" content="Tore Selland Kleppe" />


<meta name="date" content="2022-10-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-specification-details.html"/>
<link rel="next" href="the-samplers.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-pdmphmc"><i class="fa fa-check"></i><b>1.1</b> What is <code>pdmphmc</code>?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-pdmphmc"><i class="fa fa-check"></i><b>1.2</b> Why <code>pdmphmc</code>?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.3</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pdmphmc-hello-world.html"><a href="pdmphmc-hello-world.html"><i class="fa fa-check"></i><b>2</b> <code>pdmphmc</code> “Hello World”</a>
<ul>
<li class="chapter" data-level="2.1" data-path="pdmphmc-hello-world.html"><a href="pdmphmc-hello-world.html#requirements"><i class="fa fa-check"></i><b>2.1</b> Requirements</a></li>
<li class="chapter" data-level="2.2" data-path="pdmphmc-hello-world.html"><a href="pdmphmc-hello-world.html#check-your-installation"><i class="fa fa-check"></i><b>2.2</b> Check your installation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-model-specification.html"><a href="the-model-specification.html"><i class="fa fa-check"></i><b>3</b> The model specification</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-model-specification.html"><a href="the-model-specification.html#simple-worked-example"><i class="fa fa-check"></i><b>3.1</b> A simple worked example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="model-specification-details.html"><a href="model-specification-details.html"><i class="fa fa-check"></i><b>4</b> Model specification details</a>
<ul>
<li class="chapter" data-level="4.1" data-path="model-specification-details.html"><a href="model-specification-details.html#data_-statements"><i class="fa fa-check"></i><b>4.1</b> <code>DATA_*</code> statements</a></li>
<li class="chapter" data-level="4.2" data-path="model-specification-details.html"><a href="model-specification-details.html#the-preprocess-function"><i class="fa fa-check"></i><b>4.2</b> The <code>preProcess()</code> function</a></li>
<li class="chapter" data-level="4.3" data-path="model-specification-details.html"><a href="model-specification-details.html#the-operator-function"><i class="fa fa-check"></i><b>4.3</b> The <code>operator()()</code> function</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="model-specification-details.html"><a href="model-specification-details.html#the-parameter_-macros"><i class="fa fa-check"></i><b>4.3.1</b> The <code>PARAMETER_*</code> macros</a></li>
<li class="chapter" data-level="4.3.2" data-path="model-specification-details.html"><a href="model-specification-details.html#specifying-the-shape-of-piboldsymbol-theta."><i class="fa fa-check"></i><b>4.3.2</b> Specifying the shape of <span class="math inline">\(\pi(\boldsymbol \theta)\)</span>.</a></li>
<li class="chapter" data-level="4.3.3" data-path="model-specification-details.html"><a href="model-specification-details.html#generated-quantities"><i class="fa fa-check"></i><b>4.3.3</b> Generated quantities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="amt-lib.html"><a href="amt-lib.html"><i class="fa fa-check"></i><b>5</b> The <code>amt</code>-library</a>
<ul>
<li class="chapter" data-level="5.1" data-path="amt-lib.html"><a href="amt-lib.html#amt-SPD-matrix"><i class="fa fa-check"></i><b>5.1</b> Utilities for symmetric positive definite matrices</a></li>
<li class="chapter" data-level="5.2" data-path="amt-lib.html"><a href="amt-lib.html#univariate-continuous-distributions"><i class="fa fa-check"></i><b>5.2</b> Univariate continuous distributions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="amt-lib.html"><a href="amt-lib.html#expgamma_ldargshapescale"><i class="fa fa-check"></i><b>5.2.1</b> <code>expGamma_ld(arg,shape,scale)</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="amt-lib.html"><a href="amt-lib.html#invlogitbeta_ldxab"><i class="fa fa-check"></i><b>5.2.2</b> <code>invLogitBeta_ld(x,a,b)</code></a></li>
<li class="chapter" data-level="5.2.3" data-path="amt-lib.html"><a href="amt-lib.html#invlogituniform_ldx"><i class="fa fa-check"></i><b>5.2.3</b> <code>invLogitUniform_ld(x)</code></a></li>
<li class="chapter" data-level="5.2.4" data-path="amt-lib.html"><a href="amt-lib.html#normal_ldargmeansd"><i class="fa fa-check"></i><b>5.2.4</b> <code>normal_ld(arg,mean,sd)</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="amt-lib.html"><a href="amt-lib.html#univariate-discrete-distributions"><i class="fa fa-check"></i><b>5.3</b> Univariate discrete distributions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="amt-lib.html"><a href="amt-lib.html#bernoulli_logit_lmyalpha"><i class="fa fa-check"></i><b>5.3.1</b> <code>bernoulli_logit_lm(y,alpha)</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="amt-lib.html"><a href="amt-lib.html#poisson_log_lmyeta"><i class="fa fa-check"></i><b>5.3.2</b> <code>poisson_log_lm(y,eta)</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="amt-lib.html"><a href="amt-lib.html#zipoisson_log_lmyetag"><i class="fa fa-check"></i><b>5.3.3</b> <code>ziPoisson_log_lm(y,eta,g)</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="amt-lib.html"><a href="amt-lib.html#distributions-on-unbounded-vectors"><i class="fa fa-check"></i><b>5.4</b> Distributions on unbounded vectors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="amt-lib.html"><a href="amt-lib.html#multi_normal_prec_ldargmuprec"><i class="fa fa-check"></i><b>5.4.1</b> <code>multi_normal_prec_ld(arg,mu,Prec)</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="amt-lib.html"><a href="amt-lib.html#iid_multi_normal_prec_ldargmuprec"><i class="fa fa-check"></i><b>5.4.2</b> <code>iid_multi_normal_prec_ld(arg,mu,Prec)</code></a></li>
<li class="chapter" data-level="5.4.3" data-path="amt-lib.html"><a href="amt-lib.html#multi_normal_ldargmusigma"><i class="fa fa-check"></i><b>5.4.3</b> <code>multi_normal_ld(arg,mu,Sigma)</code></a></li>
<li class="chapter" data-level="5.4.4" data-path="amt-lib.html"><a href="amt-lib.html#normalar1_ldargmuphisigma"><i class="fa fa-check"></i><b>5.4.4</b> <code>normalAR1_ld(arg,mu,phi,sigma)</code></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="amt-lib.html"><a href="amt-lib.html#distributions-on-symmetric-positive-definite-matrices"><i class="fa fa-check"></i><b>5.5</b> Distributions on symmetric positive definite matrices</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-samplers.html"><a href="the-samplers.html"><i class="fa fa-check"></i><b>6</b> The sampling algorithms</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-samplers.html"><a href="the-samplers.html#fixed-mass-sampler"><i class="fa fa-check"></i><b>6.1</b> Fixed mass sampler</a></li>
<li class="chapter" data-level="6.2" data-path="the-samplers.html"><a href="the-samplers.html#Riemann-manifold"><i class="fa fa-check"></i><b>6.2</b> Riemann manifold sampler</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="the-samplers.html"><a href="the-samplers.html#metric-tensor-storage"><i class="fa fa-check"></i><b>6.2.1</b> Metric tensor storage</a></li>
<li class="chapter" data-level="6.2.2" data-path="the-samplers.html"><a href="the-samplers.html#advanced"><i class="fa fa-check"></i><b>6.2.2</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="the-samplers.html"><a href="the-samplers.html#ODE-solvers"><i class="fa fa-check"></i><b>6.3</b> ODE solvers</a></li>
<li class="chapter" data-level="6.4" data-path="the-samplers.html"><a href="the-samplers.html#scaling-adaptation"><i class="fa fa-check"></i><b>6.4</b> Scaling adaptation</a></li>
<li class="chapter" data-level="6.5" data-path="the-samplers.html"><a href="the-samplers.html#event-intensity"><i class="fa fa-check"></i><b>6.5</b> Event intensity</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="worked-examples.html"><a href="worked-examples.html"><i class="fa fa-check"></i><b>7</b> Worked examples</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">pdmphmc - numerical generalized randomized HMC processes for <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="amt-lib" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> The <code>amt</code>-library<a href="amt-lib.html#amt-lib" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section gives an overview of the different probability density/mass functions, in addition to some utility functions available in the <code>amt</code>-library. The library provides an automatic
implementation of the methodology of <span class="citation">Kleppe (<a href="#ref-kleppe_amt" role="doc-biblioref">2022a</a>)</span> for automatically computing a “metric tensors” suitable Riemannian sampling algorithms for arbitrary models.</p>
<p>The design of the library allows the user to use the same model specification for both Riemannian and regular fixed metric sampling (see Chapter <a href="the-samplers.html#the-samplers">6</a>).</p>
<p>The methodology of <span class="citation">Kleppe (<a href="#ref-kleppe_amt" role="doc-biblioref">2022a</a>)</span> generally requires that all probability densities involved in the model where the argument depends on <span class="math inline">\(\boldsymbol \theta\)</span> (generally the conditional densities of priors and latent variables) to have continuous first order derivatives. To achieve such continuity, many of the below distributions are known probability distributions that have been transformed to have support on the whole real line in such a way that the resulting probability distribution is sufficiently smooth. These transformations are also desirable from a numerical point of view.</p>
<p>As a basic example of such transformations involves the <span class="math inline">\(ExpGamma\)</span>-distribution (see below for proper definition):</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode cc"><code class="sourceCode cpp"><span id="cb49-1"><a href="amt-lib.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">// inside operator()()</span></span>
<span id="cb49-2"><a href="amt-lib.html#cb49-2" aria-hidden="true" tabindex="-1"></a>PARAMETER_SCALAR<span class="op">(</span>logSigma<span class="op">,</span><span class="fl">0.0</span><span class="op">);</span></span>
<span id="cb49-3"><a href="amt-lib.html#cb49-3" aria-hidden="true" tabindex="-1"></a>model__<span class="op">+=</span>expGamma_ld<span class="op">(</span>logSigma<span class="op">,</span><span class="fl">1.0</span><span class="op">,</span><span class="fl">1.0</span><span class="op">);</span></span>
<span id="cb49-4"><a href="amt-lib.html#cb49-4" aria-hidden="true" tabindex="-1"></a>varType sigma<span class="op">=</span>exp<span class="op">(</span>logSigma<span class="op">);</span> </span>
<span id="cb49-5"><a href="amt-lib.html#cb49-5" aria-hidden="true" tabindex="-1"></a>model__<span class="op">.</span>generated<span class="op">(</span>asDouble<span class="op">(</span>sigma<span class="op">),</span><span class="st">&quot;sigma&quot;</span><span class="op">);</span></span></code></pre></div>
<p>In the above example, <code>sigma</code> will be exponentially distributed with mean 1 (until further conditioning is done) and will be recorded as a generated quantity.</p>
<div id="amt-SPD-matrix" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Utilities for symmetric positive definite matrices<a href="amt-lib.html#amt-SPD-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>amt</code>-package provides a set of utilities for representing symmetric positive definite (SPD) matrices. Internally, this class template <code>SPDmatrix</code> represents a <span class="math inline">\(d \times d\)</span> SPD matrix as an “internal” vector of <span class="math inline">\(d(d+1)/2\)</span> <code>varTypes</code>.</p>
<p><code>SPDmatrix</code> objects may be used as e.g. covariance- or precision matrices in multivariate normal distributions, and it also possible to assign e.g. Wishart distributions on such objects (though in practice, such assignments are really distributions on the internal vector, consistent with the matrix-valued distribution).</p>
<p>The easiest way to construct a <code>SPDmatrix</code> is via the <code>PARAMETER_SPD_MATRIX(name,dim,...)</code> macro. Typical usage involves something like:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode cc"><code class="sourceCode cpp"><span id="cb50-1"><a href="amt-lib.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">// inside operator()() : </span></span>
<span id="cb50-2"><a href="amt-lib.html#cb50-2" aria-hidden="true" tabindex="-1"></a>PARAMETER_SPD_MATRIX<span class="op">(</span>P<span class="op">,</span><span class="dv">3</span><span class="op">);</span> </span>
<span id="cb50-3"><a href="amt-lib.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Note: PARAMETER_SPD_MATRIX(P,3) really makes a parameter vector  </span></span>
<span id="cb50-4"><a href="amt-lib.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">// named P_internal, and subsequently constructs SPDmatrix&lt;varType&gt; P</span></span>
<span id="cb50-5"><a href="amt-lib.html#cb50-5" aria-hidden="true" tabindex="-1"></a>Eigen<span class="op">::</span>VectorXd scaleDiag<span class="op">;</span> scaleDiag<span class="op">.</span>setConstant<span class="op">(</span><span class="dv">3</span><span class="op">,</span><span class="fl">4.0</span><span class="op">);</span></span>
<span id="cb50-6"><a href="amt-lib.html#cb50-6" aria-hidden="true" tabindex="-1"></a>model__ <span class="op">+=</span> wishartDiagScale_ld<span class="op">(</span>P<span class="op">,</span>scaleDiag<span class="op">,</span><span class="fl">10.0</span><span class="op">);</span> </span>
<span id="cb50-7"><a href="amt-lib.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co">// P has a Wishart(4*I,10.0) distribution a priori </span></span>
<span id="cb50-8"><a href="amt-lib.html#cb50-8" aria-hidden="true" tabindex="-1"></a>model__<span class="op">.</span>generated<span class="op">(</span>P<span class="op">,</span><span class="st">&quot;P&quot;</span><span class="op">);</span> <span class="co">// full matrix stored</span></span>
<span id="cb50-9"><a href="amt-lib.html#cb50-9" aria-hidden="true" tabindex="-1"></a>model__<span class="op">.</span>generated<span class="op">(</span>P<span class="op">.</span>coeff<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">2</span><span class="op">),</span><span class="st">&quot;P13&quot;</span><span class="op">);</span> <span class="co">// single element stored</span></span></code></pre></div>
<p>A complete class where the above code block is the body of the <code>operator()()</code>-method is stored in the file <code>wishart_example.cpp</code>, which is built an run via:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="amt-lib.html#cb51-1" aria-hidden="true" tabindex="-1"></a>mdl <span class="ot">&lt;-</span> pdmphmc<span class="sc">::</span><span class="fu">build</span>(<span class="st">&quot;wishart_example.cpp&quot;</span>)</span></code></pre></div>
<pre><code>## model name : model</code></pre>
<pre><code>## process type : HMCProcess</code></pre>
<pre><code>## metric tensor type : metricTensorDummy</code></pre>
<pre><code>## compilation exited successfully</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="amt-lib.html#cb56-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> pdmphmc<span class="sc">::</span><span class="fu">run</span>(mdl)</span>
<span id="cb56-2"><a href="amt-lib.html#cb56-2" aria-hidden="true" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>## run output for model: model</code></pre>
<pre><code>## # of chains : 4</code></pre>
<pre><code>## Summary based on discrete samples:</code></pre>
<pre><code>##                 mean se_mean     sd n_eff  Rhat
## P_internal[1]  3.570   0.010  0.491  2369 1.002
## P_internal[2]  3.468   0.010  0.492  2455 1.004
## P_internal[3]  3.330   0.010  0.542  3228 1.001
## P_internal[4]  0.000   0.007  0.366  3128 1.002
## P_internal[5] -0.008   0.007  0.362  2862 1.001
## P_internal[6]  0.008   0.007  0.377  2577 1.002
## P[1,1]        39.708   0.370 18.407  2467 1.002
## P[2,1]         0.134   0.229 12.988  3225 1.002
## P[3,1]        -0.025   0.241 12.947  2874 1.000
## P[2,2]        40.107   0.347 17.647  2581 1.003
## P[3,2]         0.284   0.248 12.982  2726 1.003
## P[3,3]        40.197   0.305 18.000  3479 1.002
## P13           -0.025   0.241 12.947  2874 1.000</code></pre>
<pre><code>## summary based on integrated samples:</code></pre>
<pre><code>##        estimate se_estimate n_eff  Rhat
## P[1,1]   39.707       0.184  1838 1.005
## P[2,1]    0.028       0.056  7138 1.034
## P[3,1]    0.053       0.053  6941 1.029
## P[2,2]   40.200       0.182  1768 1.001
## P[3,2]    0.144       0.101  2184 1.002
## P[3,3]   40.235       0.163  2335 1.001
## P13       0.053       0.053  6941 1.029</code></pre>
<pre><code>## NOTE: integrated samples do NOT reflect the complete target distibution, only indicated moments with respect to the target distribution</code></pre>
<p>Notice that by default, the “internal” parameter vector <code>P_internal</code> is stored<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> in addition to the generated quantities. Note, in this case, we would expect <span class="math inline">\(E(\mathbf P)=40 \mathbf I\)</span>.</p>
</div>
<div id="univariate-continuous-distributions" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Univariate continuous distributions<a href="amt-lib.html#univariate-continuous-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="expgamma_ldargshapescale" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> <code>expGamma_ld(arg,shape,scale)</code><a href="amt-lib.html#expgamma_ldargshapescale" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The distribution obtained by applying the (natural) logarithm to a gamma-distributed random variable with shape parameter <span class="math inline">\(\alpha=\)</span><code>shape</code> and scale parameter <span class="math inline">\(\beta=\)</span><code>scale</code>. Argument of resulting PDF <span class="math inline">\(x=\)</span><code>arg</code>. Log-density:
<span class="math display">\[
\log p(x|\alpha,\beta) = -a\log(b) - \log(\Gamma(a)) + ax - \exp(x)/b.
\]</span></p>
</div>
<div id="invlogitbeta_ldxab" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> <code>invLogitBeta_ld(x,a,b)</code><a href="amt-lib.html#invlogitbeta_ldxab" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The distribution obtained by applying the logit-function to a Beta distributed random variable with shape parameters <code>a</code> and <code>b</code>. Argument of resulting PDF: <span class="math inline">\(x=\)</span><code>x</code>. Log-density:
<span class="math display">\[
\log p(x|a,b) = \log(\Gamma(a+b)) - \log(\Gamma(a)\Gamma(b)) + a\log\left(\frac{\exp(x)}{1+\exp(x)}\right) - b\log(1+\exp(x)).
\]</span></p>
</div>
<div id="invlogituniform_ldx" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> <code>invLogitUniform_ld(x)</code><a href="amt-lib.html#invlogituniform_ldx" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The distribution obtained by applying the logit-function to a uniform(0,1); same as the standard logistic distribution. Argument of resulting PDF: <span class="math inline">\(x=\)</span><code>x</code>. Log-density:
<span class="math display">\[
\log p(x) = x - 2\log(1+\exp(x))
\]</span></p>
</div>
<div id="normal_ldargmeansd" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> <code>normal_ld(arg,mean,sd)</code><a href="amt-lib.html#normal_ldargmeansd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Normal/Gaussian distribution with mean=<code>mean</code> and standard deviation=<code>sd</code>. Argument of PDF: <span class="math inline">\(x=\)</span><code>arg</code>.</p>
</div>
</div>
<div id="univariate-discrete-distributions" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Univariate discrete distributions<a href="amt-lib.html#univariate-discrete-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bernoulli_logit_lmyalpha" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> <code>bernoulli_logit_lm(y,alpha)</code><a href="amt-lib.html#bernoulli_logit_lmyalpha" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bernoulli-distribution with <span class="math inline">\(P(y=1)=\exp(\alpha)/(1+\exp(\alpha))\)</span>. Argument <span class="math inline">\(y\)</span> is of integer type.</p>
</div>
<div id="poisson_log_lmyeta" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> <code>poisson_log_lm(y,eta)</code><a href="amt-lib.html#poisson_log_lmyeta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Poisson distribution with mean equal to <span class="math inline">\(\exp(\eta)\)</span>. Argument <span class="math inline">\(y\)</span> is of integer type.</p>
</div>
<div id="zipoisson_log_lmyetag" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> <code>ziPoisson_log_lm(y,eta,g)</code><a href="amt-lib.html#zipoisson_log_lmyetag" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Zero-inflated Poisson distribution. A mixture of point-mass at <span class="math inline">\(y=0\)</span> (with weight <span class="math inline">\(p\)</span>) and a regular Poisson distribution with mean <span class="math inline">\(\exp(\eta)\)</span> (with weight <span class="math inline">\(1-p\)</span>). <span class="math inline">\(g=\text{logit}(p)\)</span>.</p>
</div>
</div>
<div id="distributions-on-unbounded-vectors" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Distributions on unbounded vectors<a href="amt-lib.html#distributions-on-unbounded-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="multi_normal_prec_ldargmuprec" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> <code>multi_normal_prec_ld(arg,mu,Prec)</code><a href="amt-lib.html#multi_normal_prec_ldargmuprec" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multivariate normal distribution where the <strong>precision</strong> matrix <code>Prec</code> is a <code>SPDmatrix</code> (see Section <a href="amt-lib.html#amt-SPD-matrix">5.1</a>). Both the argument <code>arg</code> and <code>mean</code> are vectors with dimension equal to <code>Prec.dim()</code>.</p>
</div>
<div id="iid_multi_normal_prec_ldargmuprec" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> <code>iid_multi_normal_prec_ld(arg,mu,Prec)</code><a href="amt-lib.html#iid_multi_normal_prec_ldargmuprec" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Same as above, but <code>arg</code> is now a matrix, where the columns are iid realizations from <span class="math inline">\(N(\mu,P^{-1})\)</span>, where <span class="math inline">\(P=\)</span><code>Prec</code>.</p>
</div>
<div id="multi_normal_ldargmusigma" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> <code>multi_normal_ld(arg,mu,Sigma)</code><a href="amt-lib.html#multi_normal_ldargmusigma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multivariate normal distribution where the <strong>covariance</strong> matrix <code>Sigma</code> is a <code>SPDmatrix</code> (see Section <a href="amt-lib.html#amt-SPD-matrix">5.1</a>). Both the argument <code>arg</code> and <code>mean</code> are vectors with dimension equal to <code>Sigma.dim()</code>.</p>
<p>To do: iid-variant of this.</p>
</div>
<div id="normalar1_ldargmuphisigma" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> <code>normalAR1_ld(arg,mu,phi,sigma)</code><a href="amt-lib.html#normalar1_ldargmuphisigma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Stationary Gaussian first order autoregressive process</p>
<p><span class="math display">\[
x_1 \sim N\left (\mu,\frac{\sigma^2}{1-\phi^2} \right), x_{t} = \mu + \phi ( x_{t-1}-\mu) + N(0,\sigma^2),t=2,\dots,T\;
\]</span>
for scalar parameters <span class="math inline">\(\mu\)</span>, <span class="math inline">\(-1&lt;\phi&lt;1\)</span> and <span class="math inline">\(\sigma&gt;0\)</span>. <span class="math inline">\(\mathbf x=\)</span><code>arg</code> is a <span class="math inline">\(T\)</span>-dimensional vector.</p>
</div>
</div>
<div id="distributions-on-symmetric-positive-definite-matrices" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Distributions on symmetric positive definite matrices<a href="amt-lib.html#distributions-on-symmetric-positive-definite-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-kleppe_amt" class="csl-entry">
———. 2022a. <span>“Automatic Metric Tensors Based on Log-Gradient Covariance for Riemannian MCMC.”</span>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>This may be avoided by using the <code>store.pars</code>-option in <code>pdmphmc::run()</code>.<a href="amt-lib.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-specification-details.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-samplers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
